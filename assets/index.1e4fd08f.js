var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,n=Object.getOwnPropertySymbols,a=Object.prototype.propertyIsEnumerable,l=(t,n,a)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a,r=(e,r)=>{for(var s in r||(r={}))t.call(r,s)&&l(e,s,r[s]);if(n)for(var s of n(r))a.call(r,s)&&l(e,s,r[s]);return e};import{C as s,a as o,N as c,L as m,b as i,c as u,d as E,u as p,e as d,f as g,M as h,g as y,h as f,i as S,j as b,k as v,l as T,t as C,m as x,B as R,T as k,n as O,F as _,R as I,o as N,p as L,q as M,r as A,D as w,s as D,v as $,w as U,P,x as B,y as F,z as j,A as G,S as K,E as Q}from"./vendor.765901cc.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(n){const a=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((n,r)=>{const s=new URL(e,a);if(self[t].moduleMap[s])return n(self[t].moduleMap[s]);const o=new Blob([`import * as m from '${s}';`,`${t}.moduleMap['${s}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){r(new Error(`Failed to import: ${e}`)),l(c)},onload(){n(self[t].moduleMap[s]),l(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("https://github.com/Birdey88/github_issue_export/assets/");function H(){const e=localStorage.getItem("org");return e||!1}function V(){const e=localStorage.getItem("token");return e||!1}const q=V(),X=s.create({baseURL:"https://api.github.com/",headers:{Authorization:`Bearer ${q}`}});function z(){return o.createElement(c,{collapseOnSelect:!0,expand:"sm",bg:"dark",variant:"dark",style:{marginBottom:10}},o.createElement(c.Brand,{as:m,to:"/"},"GitHub Export Utility"),o.createElement(c.Toggle,{"aria-controls":"responsive-navbar-nav"}),o.createElement(c.Collapse,{id:"responsive-navbar-nav"},o.createElement(i,{className:"mr-auto"},o.createElement(u,{as:m,active:"/Repos"===window.location.pathname,to:"/Repos"},"Repos"),o.createElement(u,{as:m,active:"/Auth"===window.location.pathname,to:"/Auth"},"Auth Details"))))}function W({children:e}){return o.createElement(o.Fragment,null,o.createElement(z,null),o.createElement(E,{className:"w-screen"},o.createElement("div",{className:"w-100"},e)))}function J(){var e;const t=p((e=>e.repos.reposList)),n=p((e=>e.repos.loading)),a=p((e=>e.repos.error)),l=d();return o.useEffect((()=>{l((e=>{const t=H();e({type:"[REPO] MAKE_REQUEST"}),X.get(`orgs/${t}/repos`).then((t=>{e({type:"[REPO] GET_DATA",payload:{reposList:t.data}})})).catch((t=>{e({type:"[REPO] ERROR",payload:{error:t}})}))}))}),[l]),o.createElement(W,null,o.createElement("h1",null,"Repos"),o.createElement("img",{src:t&&(null==(e=t[0])?void 0:e.owner.avatar_url),alt:""}),n&&o.createElement("h1",null,"Loading..."),a&&o.createElement("h1",null,"Error. Try Refreshing. ",a.message),o.createElement(g.ResponsiveMasonry,{columnsCountBreakPoints:{350:1,750:2,900:3}},o.createElement(h,{gutter:"10px"},t?t.sort(((e,t)=>t.open_issues-e.open_issues)).map((e=>o.createElement(y,{key:e.id,style:{width:"18rem"}},o.createElement(y.Header,null,o.createElement("strong",null,e.name)),o.createElement(y.Body,null,o.createElement("p",null,e.description&&e.description),o.createElement("p",null,`Open Issues: ${e.open_issues}`),o.createElement("p",null,o.createElement(m,{to:`/issues/${e.id}/${e.name}`},"See Issues")))))):o.createElement("div",null))))}function Y(){return o.createElement(J,null)}console.log(window.location);const Z=[C,e=>t=>n=>{console.log("dispatching",n);let a=t(n);return console.log("next state",e.getState()),a}],ee=T(S({issues:function(e={},t){switch(t.type){case"[ISSUES] MAKE_REQUEST":return r(r({},e),{loading:!0,issuesList:[]});case"[ISSUES] GET_DATA":return r(r({},e),{loading:!1,error:"",issuesList:t.payload.issuesList,numOfPages:t.payload.numOfPages,totalIssues:t.payload.totalIssues});case"[ISSUES] GET_ALL_DATA":return r(r({},e),{loading:!1,error:"",issuesList:t.payload.issuesList,numOfPages:1,totalIssues:t.payload.totalIssues});case"[ISSUES] ERROR":return r(r({},e),{loading:!1,error:t.payload.error,issuesList:[]});default:return e}},repos:function(e={},t){switch(t.type){case"[REPO] MAKE_REQUEST":return r(r({},e),{loading:!0,reposList:[]});case"[REPO] GET_DATA":return r(r({},e),{loading:!1,reposList:t.payload.reposList});case"[REPO] ERROR":return r(r({},e),{loading:!1,error:t.payload.error,reposList:[]});default:return e}},comments:function(e={commentsList:new Map},t){switch(t.type){case"[COMMENTS] MAKE_REQUEST":return f(e,{loading:{$set:!0}});case"[COMMENTS] GET_DATA":let n=new Map(e.commentsList);return n.set(t.payload.issueNumber,t.payload.commentData),r(r({},e),{loading:!1,commentsList:n});case"[COMMENTS] ERROR":return f(e,{loading:{$set:!1},error:{$set:t.payload.error}});default:return e}}}),("object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({trace:!0,traceLimit:25}):b)(v(...Z)));function te(){const e=x();return o.createElement(R,{variant:"dark",className:"mb-2 ml-3",onClick:()=>{e.goBack()}},o.createElement("span",null,"Back"))}function ne({formData:e}){const t=p((e=>e.issues.issuesList));return o.createElement(o.Fragment,null,o.createElement(k,{striped:!0,bordered:!0,hover:!0},o.createElement("thead",null,o.createElement("tr",null,e.number&&o.createElement("th",null,"Number"),e.title&&o.createElement("th",null,"Title"),e.state&&o.createElement("th",null,"State"),e.milestone&&o.createElement("th",null,"Milestone"),e.createdDate&&o.createElement("th",null,"Created Date"))),o.createElement("tbody",null,t&&t.sort((n="-state",a=1,"-"===n[0]&&(a=-1,n=n.substr(1)),function(e,t){return(e[n]<t[n]?-1:e[n]>t[n]?1:0)*a})).map((t=>o.createElement("tr",{key:t.id},e.number&&o.createElement("td",null,"#",t.number),e.title&&o.createElement("td",null,t.title),e.state&&o.createElement("td",null,t.state),e.milestone&&o.createElement("td",null,t.milestone&&t.milestone.title),e.createdDate&&o.createElement("td",null,new Date(t.created_at).toLocaleDateString())))))));var n,a}function ae(){const{repoName:e}=O(),t=p((e=>e.issues.issuesList)),[n,a]=o.useState({number:!0,title:!0,state:!1,milestone:!1,createdDate:!1}),[l,s]=o.useState(!0),[c,m]=o.useState(!1),i=e=>{const t=e.target.name,n=e.target.checked;a((e=>r(r({},e),{[t]:n})))};return o.createElement("div",null,o.createElement(W,null,l&&o.createElement(o.Fragment,null,o.createElement(_,null,o.createElement("h1",null,`Export - ${e} (Issues for export: ${t.length})`),o.createElement("h3",null,"Tick to enable in the export:"),o.createElement(_.Group,{as:I},o.createElement(_.Check,{type:"checkbox",label:"Number",name:"number",checked:n.number,style:{marginLeft:"10px"},onChange:i}),o.createElement(_.Check,{type:"checkbox",label:"Title",name:"title",checked:n.title,style:{marginLeft:"10px"},onChange:i}),o.createElement(_.Check,{type:"checkbox",label:"State",name:"state",checked:n.state,style:{marginLeft:"10px"},onChange:i}),o.createElement(_.Check,{type:"checkbox",label:"Milestone",name:"milestone",checked:n.milestone,style:{marginLeft:"10px"},onChange:i}),o.createElement(_.Check,{type:"checkbox",label:"Created Date",name:"createdDate",checked:n.createdDate,style:{marginLeft:"10px"},onChange:i})),o.createElement(te,null),o.createElement(R,{variant:"primary",type:"button",onClick:e=>{s(!1),m(!0)},className:"ml-2 mb-2"},"Export"))),c&&o.createElement(o.Fragment,null,o.createElement(R,{variant:"primary",type:"button",style:{margin:"10px"},onClick:()=>{s(!0),m(!1)}},"Back"),o.createElement(ne,{formData:n}))))}function le(e,t="#FFFFFF",n="#000000"){var a="#"===e.charAt(0)?e.substring(1,7):e,l=[parseInt(a.substring(0,2),16)/255,parseInt(a.substring(2,4),16)/255,parseInt(a.substring(4,6),16)/255].map((e=>e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)));return.2126*l[0]+.7152*l[1]+.0722*l[2]>.179?n:t}function re({color:e,text:t}){return o.createElement("div",{style:{backgroundColor:`#${e}`,borderRadius:"20px",textAlign:"center",padding:"4px",margin:"2px",position:"relative",color:le(e),marginBottom:"10px"}},t)}function se({labels:e}){return e.map((e=>o.createElement("div",{key:e.id},o.createElement(re,{color:e.color,text:e.name}))))}function oe({login:e}){return o.createElement("div",{className:"d-none d-md-block"},"Assignees: ",e)}function ce({assignees:e}){return e.map((e=>o.createElement("div",{key:e.id},o.createElement(oe,{login:e.login}))))}function me({repoName:e,issueNumber:t}){var n;const a=p((e=>e.comments.commentsList)),l=d();return o.useEffect((()=>{l(((e,t)=>n=>{const a=H();n({type:"[COMMENTS] MAKE_REQUEST"}),X.get(`repos/${a}/${e}/issues/${t}/comments`).then((e=>{n({type:"[COMMENTS] GET_DATA",payload:{issueNumber:t,commentData:e.data}})})).catch((e=>{n({type:"[COMMENTS] ERROR",payload:{error:e}})}))})(e,t))}),[e,t,l]),o.createElement(o.Fragment,null,o.createElement("h6",null,"Comments:"),o.createElement(N,null,a&&(null==(n=a.get(t))?void 0:n.map((e=>{var t,n;return o.createElement(N.Item,{key:e.id},o.createElement(I,null,o.createElement(L,{xs:1},o.createElement("img",{src:null==(t=e.user)?void 0:t.avatar_url,alt:"",style:{width:40,height:40}})),o.createElement(L,null,o.createElement("strong",null,null==(n=e.user)?void 0:n.login))),o.createElement(I,{style:{marginTop:10}},null==e?void 0:e.body))})))))}function ie({issue:e,repoName:t}){const[n,a]=o.useState(!1),[l,r]=o.useState(!1),s=p((e=>e.comments.loading)),c=p((e=>e.comments.error));return o.createElement(y,{className:"mb-2"},o.createElement(y.Body,null,o.createElement("div",{className:"d-flex"},o.createElement("div",null,o.createElement(y.Title,null,o.createElement("a",{href:e.html_url&&e.html_url},"#",e.number," - ",e.title)),o.createElement(y.Subtitle,null,o.createElement("div",{style:{display:"grid",gridAutoFlow:"column"}},o.createElement(se,{labels:e.labels}))),o.createElement(y.Subtitle,{className:"text-dark mb-2"},o.createElement("p",null,e.state.toLowerCase().split(" ").map((function(e){return e.replace(e[0],e[0].toUpperCase())})).join(" ")),e.milestone&&o.createElement("h6",null,"Milestone: ",e.milestone.title),e.assignees&&o.createElement(ce,{assignees:e.assignees})),o.createElement(y.Subtitle,{className:"text-muted mb-2"},new Date(e.created_at).toLocaleDateString()))),o.createElement(y.Text,null,e.body?o.createElement(R,{onClick:()=>a((e=>!e)),variant:n?"secondary":"primary",className:"mr-2"},n?"Hide Details":"View Details"):o.createElement("div",null,"No details for this issue"),e.comments?o.createElement(R,{onClick:()=>r((e=>!e)),variant:l?"secondary":"primary",className:"mr-2"},l?"Hide Comments":"View Comments"):o.createElement("div",null,"No comments for this issue")),o.createElement(M,{in:n},o.createElement("div",null,o.createElement("h6",null,"Details:"),e.body&&o.createElement(A,{children:e.body,className:"mt-4 overflow-hidden"}))),o.createElement(M,{in:l},o.createElement(N,null,s&&o.createElement("h4",null,"Loading..."),c&&o.createElement("h4",null,"Error. Try Refreshing. ",c.message),l&&o.createElement(me,{issueNumber:e.number,repoName:t})))))}function ue(e){let t=[];if(e){for(const[n,a]of Object.entries(e))"title"===n&&" in:title"!==a&&t.push(a),"milestone"===n&&"milestone:"!==a&&t.push(a),"state"===n&&"state:"!==a&&t.push(a);return t.join(" ")}return""}const Ee=(e,t,n)=>a=>{const l=ue(t),r=H();let s=[];const o=[];a({type:"[ISSUES] MAKE_REQUEST"});for(let t=1;t<n+1;t++)o.push(X.get("search/issues",{params:{q:`repo:${r}/${e} ${l||""}`,page:t}}).then((e=>{s.push(e.data.items)})).catch((e=>{a({type:"[ISSUES] ERROR",payload:{error:e}})})));Promise.all(o).then((()=>{a({type:"[ISSUES] GET_ALL_DATA",payload:{issuesList:s.flat(1),totalIssues:s.flat(1).length}})}))};function pe({issues:e,handleMilestoneChange:t,milestoneTitle:n}){const a=function(e){if(!e)return;let t=[...new Set(e.map((e=>e.milestone?e.milestone.title:"")))];return t.push("All Milestones"),t}(e);return o.createElement(w,{title:n,variant:"success"},a&&a.map((e=>o.createElement(D.Item,{key:e,eventKey:e,onSelect:t},e))))}function de({handleMilestoneChange:e,handleTitleChange:t,handleStateChange:n,handleAllIssuesButton:a,toggleAllIssues:l,milestoneTitle:r,issues:s}){return o.createElement(_,{className:"mb-4 w-100"},o.createElement(y,null,o.createElement(y.Body,null,o.createElement(y.Title,null,"Search"),o.createElement(I,null,o.createElement(L,{xs:5},o.createElement(_.Control,{onChange:t,type:"text",name:"title",placeholder:"Title"})),o.createElement(L,{className:"text-center"},o.createElement(pe,{handleMilestoneChange:e,issues:s,milestoneTitle:r})),o.createElement(L,{className:"text-center"},o.createElement($,{type:"radio",defaultValue:"all",name:"state"},[{name:"All",value:"all"},{name:"Open",value:"open"},{name:"Closed",value:"closed"}].map(((e,t)=>o.createElement(U,{key:t,value:e.value,onChange:e=>n(e.currentTarget.value),variant:"success"},e.name))))),o.createElement(L,null,o.createElement(R,{className:"ml-2 mb-2",onClick:a,variant:"success"},l?"Hide":"Show"," All Issues"))))))}function ge({page:e,setPage:t,numOfPages:n}){function a(e){t((t=>t+e))}const l=t=>{a(t-e)};return o.createElement(P,{className:"ml-3"},e>2&&o.createElement(P.First,{onClick:()=>l(1)}),1!==e&&o.createElement(P.Prev,{onClick:()=>a(-1)}),1!==e&&o.createElement(P.Item,{onClick:()=>t(1)},"1"),e>2&&o.createElement(P.Item,{onClick:()=>a(-1)},e-1),o.createElement(P.Item,{active:!0},e),e!==n&&o.createElement(P.Item,{onClick:()=>a(1)},e+1),e!==n&&o.createElement(P.Next,{onClick:()=>a(1)}),e<28&&e!==n&&o.createElement(P.Last,{onClick:()=>l(n)}))}function he(){const e=x(),t=p((e=>e.issues.issuesList)),n=p((e=>e.issues.totalIssues)),a=p((e=>e.issues.loading)),l=p((e=>e.issues.error)),s=p((e=>e.issues.numOfPages)),[c,i]=o.useState(!1),[u,g]=o.useState(),[h,y]=o.useState(1),[f,S]=o.useState("Milestones"),b=d(),{id:v}=O(),{repoName:T}=O();let C;return o.useEffect((()=>{b(((e,t,n)=>a=>{const l=ue(t),r=H();a({type:"[ISSUES] MAKE_REQUEST"}),X.get("search/issues",{params:{q:`repo:${r}/${e} ${l||""}`,page:n}}).then((e=>{console.info(e),a({type:"[ISSUES] GET_DATA",payload:{issuesList:e.data.items,totalIssues:e.data.total_count,numOfPages:Math.ceil(e.data.total_count/30)<30?Math.ceil(e.data.total_count/30):30}})})).catch((e=>{a({type:"[ISSUES] ERROR",payload:{error:e}})}))})(T,u,h))}),[u,b,T,h]),o.useEffect((()=>{b(((e,t)=>n=>{const a=H();n({type:"[ISSUES] MAKE_REQUEST"}),X.get("search/issues",{params:{q:`repo:${a}/${e}`,page:t}}).then((e=>{n({type:"[ISSUES] GET_DATA",payload:{issuesList:e.data.items,numOfPages:Math.ceil(e.data.total_count/30)<30?Math.ceil(e.data.total_count/30):30,totalIssues:e.data.total_count}})})).catch((e=>{n({type:"[ISSUES] ERROR",payload:{error:e}})}))})(T,h))}),[b,T,h]),o.createElement(W,null,o.createElement(E,null,o.createElement(I,null,o.createElement("h1",null,`Issues for ${T}`)),o.createElement(I,null,o.createElement(te,null)),o.createElement(I,null,o.createElement(de,{handleMilestoneChange:e=>{clearTimeout(C),i(!1),"All Milestones"===e?(e="",S("Milestones")):S(e);const t=`milestone:${e}`;C=setTimeout((()=>{g((e=>r(r({},e),{milestone:t})))}),900)},handleTitleChange:e=>{clearTimeout(C);const t=e.target.value;C=setTimeout((()=>{g((e=>r(r({},e),{title:t})))}),900)},handleStateChange:e=>{if(i(!1),e){let t=`state:${e.toLowerCase()}`;"all"===e&&(t="");const n="state";g((e=>r(r({},e),{[n]:t})))}},handleAllIssuesButton:()=>{g(""),b(Ee(T,u,s)),i(!c)},displayAllIssues:c,milestoneTitle:f,issues:t})),o.createElement(I,null,o.createElement(L,null,s>1&&o.createElement(ge,{page:h,setPage:y,numOfPages:s})),o.createElement(L,{className:"text-right"},o.createElement(m,{to:`/export/${v}/${T}`},o.createElement(R,{className:"ml-3 mb-2"},"Export ",t&&t.length," issues on this page")),n!==t&&t.length>0?o.createElement(R,{className:"ml-2 mb-2",onClick:()=>{c||b(Ee(T,u,s)),e.push(`/Export/${v}/${T}`)}},"Export all ",n," Issues"):null)),o.createElement(I,null,a&&o.createElement("h1",null,"Loading..."),l&&o.createElement("h1",null,"Error. Try Refreshing. ",l.message)),o.createElement(I,{xs:1},t&&t.map((e=>o.createElement(L,{key:e.id},o.createElement(ie,{key:e.id,issue:e,repoName:T}))))),o.createElement(I,{style:{display:"flex",alignItems:"right"}},o.createElement(L,null,s>1&&o.createElement(ge,{page:h,setPage:y,numOfPages:s})),o.createElement(L,{className:"text-right"},"Number of issues in search: ",n,s>1&&o.createElement("div",null,"Pages: ",s)))))}function ye(){const[e,t]=o.useState(),n=o.useRef(),a=o.useRef(),l=x();o.useEffect((()=>{const e=localStorage.getItem("token"),t=localStorage.getItem("org");e&&(a.current.value=e),t&&(n.current.value=t)}),[]);const r=e=>{};return o.createElement(W,null,o.createElement("h2",null,"Please enter in your personal GitHub Token and Organisation here:"),o.createElement(_,null,o.createElement(_.Control,{style:{marginTop:"10px",maxWidth:"50vw"},placeholder:"Github Token",onChange:r,name:"org",ref:a}),o.createElement(_.Control,{style:{marginTop:"10px",maxWidth:"50vw"},placeholder:"Organisation as it appears in GitHub",onChange:r,name:"token",ref:n}),o.createElement(R,{style:{marginTop:"10px"},onClick:()=>{t("");const e=n.current.value,r=a.current.value;e&&r?(localStorage.setItem("token",r),localStorage.setItem("org",e),l.push("/")):t("Sorry you need to enter the correct data")}},"Submit")),e&&o.createElement("h2",{style:{color:"red"}},e))}function fe(e){var{component:l}=e,s=((e,l)=>{var r={};for(var s in e)t.call(e,s)&&l.indexOf(s)<0&&(r[s]=e[s]);if(null!=e&&n)for(var s of n(e))l.indexOf(s)<0&&a.call(e,s)&&(r[s]=e[s]);return r})(e,["component"]);const c=V(),m=H();return o.createElement(B,r(r({},s),{render:e=>c&&m?o.createElement(l,r({},e)):o.createElement(F,{to:"/Auth"})}))}function Se(){return o.createElement(j,{store:ee},o.createElement(G,null,o.createElement(K,null,o.createElement(fe,{exact:!0,path:"/",component:Y}),o.createElement(B,{exact:!0,path:"/Auth",component:ye}),o.createElement(fe,{exact:!0,path:"/Repos",component:J}),o.createElement(fe,{exact:!0,path:"/Issues/:id/:repoName",component:he}),o.createElement(fe,{exact:!0,path:"/Export/:id/:repoName",component:ae}))))}Q.render(o.createElement(o.StrictMode,null,o.createElement(Se,null)),document.getElementById("root"));
